javascript:(async()=>{var e=new Set;let a=1,r=0;for(;;){var t=Array.from(window.frames??"").find(e=>e.location.href.includes("txtbk_show_chapter.php"));if(!t){alert("WebClassで資料ページを開いてください。");break}if("function"!=typeof t.gopage){alert("E: gopage is not a function");break}t.gopage(a);var t=t.document.querySelector(`table#TOCLayout tr[data-page="${a}"] td:nth-child(3) span`)?.innerText.replace(/_/g,"")||"Unnamed File No"+a,o=(await new Promise(e=>setTimeout(e,1e3)),Array.from(window.frames).find(e=>e.location.href.includes("loadit.php")));if(o){o=Array.from(o.frames).find(e=>e.location.href.includes("loadit.php"));if(o){o=o.document.querySelector("a");if(o){if(e.has(o.href)){alert(a-1+"個のファイルをダウンロードしました。");break}e.add(o.href);o=await(await fetch(o.href)).blob();if(!(t=prompt(a+"個目のファイル名を入力",t)))return;var i=document.createElement("a");i.href=URL.createObjectURL(o),i.download=t,i.click(),URL.revokeObjectURL(i.href),a++}else{if(r==a){alert(a-1+"個のファイルをダウンロードしました。");break}alert(a+"個目のファイルはダウンロード可能に設定されていません。"),r=a}}else{if(r==a){alert(a-1+"個のファイルをダウンロードしました。");break}alert(a+"個目のファイルはダウンロード可能な形式ではありません。"),r=a}}else{if(r==a){alert(a-1+"個のファイルをダウンロードしました。");break}alert(a+"個目のファイルはダウンロード可能な形式ではありません。"),r=a}}})();